<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Penghilang Blur Foto</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .upload-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .upload-area {
            border: 2px dashed rgba(255, 255, 255, 0.5);
            border-radius: 10px;
            padding: 40px 20px;
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: rgba(255, 255, 255, 0.8);
            background: rgba(255, 255, 255, 0.05);
        }

        .upload-icon {
            font-size: 50px;
            margin-bottom: 15px;
        }

        .file-input {
            display: none;
        }

        .btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .btn:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: #ff9800;
        }

        .btn-secondary:hover {
            background: #e68900;
        }

        .processing-section {
            display: none;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .controls {
            margin: 20px 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
        }

        .slider-container {
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .slider {
            width: 100%;
            height: 10px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.2);
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4CAF50;
            cursor: pointer;
        }

        .images-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 30px;
            margin-top: 30px;
        }

        .image-box {
            flex: 1;
            min-width: 300px;
            text-align: center;
        }

        .image-box h3 {
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .image-preview {
            max-width: 100%;
            max-height: 400px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }

        .spinner {
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-top: 5px solid #fff;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .info-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .info-section h2 {
            margin-bottom: 15px;
            font-size: 1.8rem;
        }

        .tips {
            margin-top: 20px;
        }

        .tips ul {
            padding-left: 20px;
            margin-top: 10px;
        }

        .tips li {
            margin-bottom: 8px;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 0.9rem;
            opacity: 0.8;
        }

        @media (max-width: 768px) {
            .images-container {
                flex-direction: column;
            }
            
            .image-box {
                min-width: 100%;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Penghilang Blur Foto</h1>
            <p class="subtitle">Unggah foto buram Anda dan tingkatkan kejelasannya dengan mudah</p>
        </header>

        <div class="app-container">
            <section class="upload-section">
                <h2>Unggah Foto</h2>
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">ðŸ“·</div>
                    <p>Seret dan lepas foto Anda di sini atau klik untuk memilih</p>
                    <p class="subtitle">Format yang didukung: JPG, PNG, GIF (Maks. 5MB)</p>
                </div>
                <input type="file" id="fileInput" class="file-input" accept="image/*">
                <button class="btn" id="uploadBtn">Pilih Foto</button>
            </section>

            <section class="processing-section" id="processingSection">
                <h2>Perbaiki Foto</h2>
                <div class="controls">
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>Intensitas Penajaman:</span>
                            <span id="intensityValue">5</span>
                        </div>
                        <input type="range" min="1" max="10" value="5" class="slider" id="intensitySlider">
                    </div>
                    <button class="btn" id="processBtn">Terapkan Penajaman</button>
                    <button class="btn btn-secondary" id="resetBtn">Reset</button>
                    <button class="btn" id="downloadBtn">Unduh Hasil</button>
                </div>

                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>Memproses gambar...</p>
                </div>

                <div class="images-container">
                    <div class="image-box">
                        <h3>Foto Asli</h3>
                        <canvas id="originalCanvas" class="image-preview"></canvas>
                    </div>
                    <div class="image-box">
                        <h3>Hasil Perbaikan</h3>
                        <canvas id="resultCanvas" class="image-preview"></canvas>
                    </div>
                </div>
            </section>

            <section class="info-section">
                <h2>Tentang Penghilang Blur Foto</h2>
                <p>Alat ini menggunakan algoritma penajaman gambar untuk mengurangi efek blur pada foto Anda. Meskipun tidak dapat sepenuhnya menghilangkan blur yang parah, alat ini dapat meningkatkan kejelasan gambar secara signifikan.</p>
                
                <div class="tips">
                    <h3>Tips untuk Hasil Terbaik:</h3>
                    <ul>
                        <li>Gunakan foto dengan resolusi tinggi untuk hasil yang lebih baik</li>
                        <li>Foto dengan blur ringan akan memberikan hasil terbaik</li>
                        <li>Eksperimen dengan pengaturan intensitas untuk menemukan keseimbangan yang tepat</li>
                        <li>Hindari foto yang sangat buram atau bergerak</li>
                    </ul>
                </div>
            </section>
        </div>

        <footer>
            <p>Â© 2023 Penghilang Blur Foto | Alat untuk meningkatkan kejelasan gambar</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elemen DOM
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const uploadBtn = document.getElementById('uploadBtn');
            const processingSection = document.getElementById('processingSection');
            const originalCanvas = document.getElementById('originalCanvas');
            const resultCanvas = document.getElementById('resultCanvas');
            const intensitySlider = document.getElementById('intensitySlider');
            const intensityValue = document.getElementById('intensityValue');
            const processBtn = document.getElementById('processBtn');
            const resetBtn = document.getElementById('resetBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const loading = document.getElementById('loading');
            
            // Konteks canvas
            const originalCtx = originalCanvas.getContext('2d');
            const resultCtx = resultCanvas.getContext('2d');
            
            // Variabel untuk menyimpan gambar
            let originalImage = null;
            let processedImage = null;
            
            // Event listener untuk area unggah
            uploadArea.addEventListener('click', () => fileInput.click());
            uploadBtn.addEventListener('click', () => fileInput.click());
            
            // Event listener untuk input file
            fileInput.addEventListener('change', handleFileUpload);
            
            // Event listener untuk drag and drop
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = '#4CAF50';
                uploadArea.style.backgroundColor = 'rgba(76, 175, 80, 0.1)';
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.style.borderColor = 'rgba(255, 255, 255, 0.5)';
                uploadArea.style.backgroundColor = 'transparent';
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = 'rgba(255, 255, 255, 0.5)';
                uploadArea.style.backgroundColor = 'transparent';
                
                if (e.dataTransfer.files.length) {
                    fileInput.files = e.dataTransfer.files;
                    handleFileUpload();
                }
            });
            
            // Event listener untuk slider
            intensitySlider.addEventListener('input', () => {
                intensityValue.textContent = intensitySlider.value;
            });
            
            // Event listener untuk tombol proses
            processBtn.addEventListener('click', processImage);
            
            // Event listener untuk tombol reset
            resetBtn.addEventListener('click', resetImage);
            
            // Event listener untuk tombol unduh
            downloadBtn.addEventListener('click', downloadImage);
            
            // Fungsi untuk menangani unggahan file
            function handleFileUpload() {
                if (!fileInput.files.length) return;
                
                const file = fileInput.files[0];
                
                // Validasi tipe file
                if (!file.type.match('image.*')) {
                    alert('Silakan unggah file gambar (JPG, PNG, GIF)');
                    return;
                }
                
                // Validasi ukuran file (maks 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    alert('Ukuran file terlalu besar. Maksimal 5MB.');
                    return;
                }
                
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    originalImage = new Image();
                    originalImage.onload = function() {
                        // Atur ukuran canvas sesuai gambar
                        const maxWidth = 500;
                        const ratio = maxWidth / originalImage.width;
                        const canvasWidth = maxWidth;
                        const canvasHeight = originalImage.height * ratio;
                        
                        originalCanvas.width = canvasWidth;
                        originalCanvas.height = canvasHeight;
                        resultCanvas.width = canvasWidth;
                        resultCanvas.height = canvasHeight;
                        
                        // Gambar gambar asli di canvas
                        originalCtx.drawImage(originalImage, 0, 0, canvasWidth, canvasHeight);
                        
                        // Tampilkan bagian pemrosesan
                        processingSection.style.display = 'block';
                        
                        // Proses gambar secara otomatis
                        processImage();
                    };
                    originalImage.src = e.target.result;
                };
                
                reader.readAsDataURL(file);
            }
            
            // Fungsi untuk memproses gambar
            function processImage() {
                if (!originalImage) return;
                
                loading.style.display = 'block';
                
                // Gunakan setTimeout untuk memberikan waktu bagi UI untuk memperbarui
                setTimeout(() => {
                    // Salin gambar asli ke canvas hasil
                    resultCtx.drawImage(originalImage, 0, 0, resultCanvas.width, resultCanvas.height);
                    
                    // Dapatkan data gambar
                    const imageData = resultCtx.getImageData(0, 0, resultCanvas.width, resultCanvas.height);
                    const data = imageData.data;
                    
                    // Terapkan filter penajaman
                    const intensity = parseInt(intensitySlider.value);
                    sharpenImage(data, resultCanvas.width, resultCanvas.height, intensity);
                    
                    // Letakkan data gambar yang diproses kembali ke canvas
                    resultCtx.putImageData(imageData, 0, 0);
                    
                    // Simpan gambar yang diproses
                    processedImage = resultCanvas.toDataURL('image/png');
                    
                    loading.style.display = 'none';
                }, 100);
            }
            
            // Fungsi untuk menerapkan filter penajaman
            function sharpenImage(data, width, height, intensity) {
                // Buat salinan data asli
                const originalData = new Uint8ClampedArray(data);
                
                // Kernel penajaman (Laplacian)
                const kernel = [
                    -1, -1, -1,
                    -1,  9, -1,
                    -1, -1, -1
                ];
                
                // Sesuaikan kernel berdasarkan intensitas
                const centerWeight = 8 + intensity;
                const edgeWeight = -intensity / 8;
                
                // Terapkan kernel ke setiap piksel
                for (let y = 1; y < height - 1; y++) {
                    for (let x = 1; x < width - 1; x++) {
                        let r = 0, g = 0, b = 0;
                        
                        // Terapkan kernel 3x3
                        for (let ky = -1; ky <= 1; ky++) {
                            for (let kx = -1; kx <= 1; kx++) {
                                const pixelIndex = ((y + ky) * width + (x + kx)) * 4;
                                const kernelValue = (ky === 0 && kx === 0) ? centerWeight : edgeWeight;
                                
                                r += originalData[pixelIndex] * kernelValue;
                                g += originalData[pixelIndex + 1] * kernelValue;
                                b += originalData[pixelIndex + 2] * kernelValue;
                            }
                        }
                        
                        // Terapkan hasil ke piksel
                        const pixelIndex = (y * width + x) * 4;
                        data[pixelIndex] = Math.max(0, Math.min(255, r));
                        data[pixelIndex + 1] = Math.max(0, Math.min(255, g));
                        data[pixelIndex + 2] = Math.max(0, Math.min(255, b));
                    }
                }
            }
            
            // Fungsi untuk mereset gambar
            function resetImage() {
                if (!originalImage) return;
                
                // Gambar ulang gambar asli
                resultCtx.drawImage(originalImage, 0, 0, resultCanvas.width, resultCanvas.height);
                processedImage = null;
                
                // Reset slider
                intensitySlider.value = 5;
                intensityValue.textContent = '5';
            }
            
            // Fungsi untuk mengunduh gambar
            function downloadImage() {
                if (!processedImage) {
                    alert('Tidak ada gambar yang diproses untuk diunduh.');
                    return;
                }
                
                const link = document.createElement('a');
                link.download = 'foto-diperbaiki.png';
                link.href = processedImage;
                link.click();
            }
        });
    </script>
</body>
</html>
